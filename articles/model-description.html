<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model description • sdmTMB</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Model description">
<meta property="og:description" content="sdmTMB">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sdmTMB</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.14.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index-standardization.html">Index standardization with sdmTMB</a>
    </li>
    <li>
      <a href="../articles/model-description.html">Model description</a>
    </li>
    <li>
      <a href="../articles/spatial-trend-models.html">Fitting spatial trend models with sdmTMB</a>
    </li>
    <li>
      <a href="../articles/threshold-models.html">Threshold modeling with sdmTMB</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/seananderson/sdmTMB/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="model-description_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Model description</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/seananderson/sdmTMB/blob/master/vignettes/model-description.Rmd"><code>vignettes/model-description.Rmd</code></a></small>
      <div class="hidden name"><code>model-description.Rmd</code></div>

    </div>

    
    

<div id="notation-conventions" class="section level2">
<h2 class="hasAnchor">
<a href="#notation-conventions" class="anchor"></a>Notation conventions</h2>
<ul>
<li><p>Bold lowercase for vectors</p></li>
<li><p>Bold subscript <span class="math inline">\(\boldsymbol{s}\)</span> since x, y</p></li>
<li><p>Bold uppercase for matrices</p></li>
<li><p><span class="math inline">\(\phi\)</span> for all ‘dispersion’ parameters for consistency with code</p></li>
<li><p>Family titles link to TMB or sdmTMB source code</p></li>
<li><p>Attempt to link math symbols to argument options in model and code symbols</p></li>
</ul>
</div>
<div id="basic-model-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-model-structure" class="anchor"></a>Basic model structure</h2>
<p><span class="math display">\[
\begin{align}
  \mathbb{E}(y_{\boldsymbol{s},t}) &amp;= \mu_{\boldsymbol{s},t},\\
  \mu_{\boldsymbol{s},t} &amp;= f^{-1}
  \left( \boldsymbol{X} \boldsymbol{\beta} + \omega_s + \epsilon_{\boldsymbol{s},t} \right),\\
  \boldsymbol{\omega} &amp;\sim \operatorname{MVNormal} \left( \boldsymbol{0}, \boldsymbol{\Sigma}_\omega \right),\\
  \boldsymbol{\epsilon}_t &amp;\sim \operatorname{MVNormal} \left( \boldsymbol{0}, \boldsymbol{\Sigma}_{\epsilon} \right).
\end{align}
\]</span> where <span class="math inline">\(f\)</span> is a link function (e.g., log or logit) and <span class="math inline">\(f^{-1}\)</span> is its inverse link.</p>
<ul>
<li><p><span class="math inline">\(\boldsymbol{X} \boldsymbol{\beta}\)</span> is defined by the <code>formula</code> argument and represents the “fixed effect” model matrix and a corresponding vector of coefficients</p></li>
<li><p><span class="math inline">\(\omega_s\)</span> are included if <code>include_spatial = TRUE</code> or if there is no spatiotemporal component (<code>time = NULL</code>)</p></li>
<li><p><span class="math inline">\(\epsilon_{\boldsymbol{s},t}\)</span> are included if there are multiple time elements and <code>spatial_only = FALSE</code> (the default if there are multiple time elements)</p></li>
</ul>
</div>
<div id="random-or-multi-level-intercepts" class="section level2">
<h2 class="hasAnchor">
<a href="#random-or-multi-level-intercepts" class="anchor"></a>Random or multi-level intercepts</h2>
<p><span class="math display">\[
\begin{align}
  \mu_{\boldsymbol{s},t} &amp;= f^{-1} \left( \ldots + \alpha_{g} + \ldots \right),\\
  \alpha_g &amp;\sim \operatorname{Normal} \left(0, \sigma_\alpha^2 \right),\\
\end{align}
\]</span></p>
<p>where <span class="math inline">\(\alpha_g\)</span> is an example optional “random” intercept—an intercept centered on zero that varies by level <span class="math inline">\(g\)</span> and is constrained by <span class="math inline">\(\sigma_\alpha\)</span>. This is defined by the <code>formula</code> argument via the <code>(1 | g)</code> syntax as in lme4 or glmmTMB.</p>
</div>
<div id="time-varying-regression-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#time-varying-regression-parameters" class="anchor"></a>Time-varying regression parameters</h2>
<p><span class="math display">\[
\begin{align}
  \mu_{\boldsymbol{s},t} &amp;= f^{-1} \left( \ldots + \gamma_{t} x_{\boldsymbol{s},t} + \ldots \right),\\
  \gamma_{t=1} &amp;\sim \operatorname{Uniform} \left(-\infty, \infty \right),\\
  \gamma_{t&gt;1} &amp;\sim \operatorname{Normal} \left(\gamma_{t-1}, \sigma^2_{\gamma} \right),
\end{align}
\]</span></p>
<p>where <span class="math inline">\(\gamma_t\)</span> is an example optional time-varying regression parameter and $x_{,t} is the corresponding predictor value. This is defined via the <code>time_varying</code> argument. E.g., <code>~ 0 + x</code>. The first value is given an implicit uniform prior. I.e., the same variable should not appear in the fixed effect formula since the initial value is estimated as part of the time-varying formula.</p>
</div>
<div id="spatial-regression-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#spatial-regression-parameters" class="anchor"></a>Spatial regression parameters</h2>
<p><span class="math display">\[
\begin{align}
  \mu_{\boldsymbol{s},t} &amp;= f^{-1} \left( \ldots + \zeta_s x_t + \ldots \right),\\
  \boldsymbol{\zeta} &amp;\sim \operatorname{MVNormal} \left( \boldsymbol{0}, \boldsymbol{\Sigma}_\zeta \right),
\end{align}
\]</span></p>
<p>where <span class="math inline">\(\zeta_s\)</span> is a regression parameter that varies spatially and <span class="math inline">\(x_t\)</span> is a predictor that is constant for a given time <span class="math inline">\(t\)</span>. Currently, <span class="math inline">\(x_t\)</span> must be the time variable itself. If you are interested in using a different predictor, contact the developers.</p>
</div>
<div id="ar1-spatiotemporal-random-fields" class="section level2">
<h2 class="hasAnchor">
<a href="#ar1-spatiotemporal-random-fields" class="anchor"></a>AR1 spatiotemporal random fields</h2>
<p>Dropping the optional <span class="math inline">\(\omega_s\)</span> for simplicity:</p>
<p><span class="math display">\[
\begin{align}
\mu_{\boldsymbol{s},t} &amp;= f^{-1} \left( \boldsymbol{X} \boldsymbol{\beta} + \delta_{\boldsymbol{s},t} \right),\\
\boldsymbol{\delta}_{t=1} &amp;\sim \operatorname{MVNormal} (\boldsymbol{0}, \boldsymbol{\Sigma}_{\epsilon}),\\
\boldsymbol{\delta}_{t&gt;1} &amp;= \rho \boldsymbol{\delta}_{t-1} + \sqrt{1 - \rho^2} \boldsymbol{\epsilon}_t,  \:
\boldsymbol{\epsilon}_t \sim \operatorname{MVNormal} \left(\boldsymbol{0}, \boldsymbol{\Sigma}_{\epsilon} \right),
\end{align}
\]</span></p>
<p>where <span class="math inline">\(\rho\)</span> is the correlation between subsequent spatiotemporal random fields. The <span class="math inline">\(\rho \boldsymbol{\delta}_{t-1} + \sqrt{1 - \rho^2}\)</span> structure ensures a stationary AR1 process.</p>
</div>
<div id="offset-terms" class="section level2">
<h2 class="hasAnchor">
<a href="#offset-terms" class="anchor"></a>Offset terms</h2>
<p>Offset terms can be included with the reserved word <code>offset</code> in the formula. E.g., <code>y ~ x + offset</code>.</p>
<p>These are included in the linear predictor as</p>
<p><span class="math display">\[
\begin{align}
  \mu_{\boldsymbol{s},t} &amp;= f^{-1} \left( \ldots + O_{\boldsymbol{s},t} + \ldots \right),
\end{align}
\]</span> where <span class="math inline">\(O_{\boldsymbol{s},t}\)</span> is an offset term—a <strong>log transformed</strong> variable without a coefficient (assuming a log link).</p>
</div>
<div id="threshold-models" class="section level2">
<h2 class="hasAnchor">
<a href="#threshold-models" class="anchor"></a>Threshold models</h2>
<div id="linear-breakpoint-threshold-models" class="section level3">
<h3 class="hasAnchor">
<a href="#linear-breakpoint-threshold-models" class="anchor"></a>Linear breakpoint threshold models</h3>
<p>TODO</p>
<p>These models can be fit by including <code>+ breakpt(x)</code> in the model formula, where <code>x</code> is a covariate.</p>
</div>
<div id="logistic-threshold-models" class="section level3">
<h3 class="hasAnchor">
<a href="#logistic-threshold-models" class="anchor"></a>Logistic threshold models</h3>
<p>The form is</p>
<p><span class="math display">\[
s(x)=\tau + \psi\ { \left[ 1+{ e }^{ -\ln\ \left(19\right) \cdot \left( x-s50 \right)
     / \left(s95 - s50 \right) } \right] }^{-1},
\]</span> where <span class="math inline">\(\psi\)</span> is a scaling parameter (controlling the height of the y-axis for the response, and is unconstrained), <span class="math inline">\(\tau\)</span> is an intercept, <span class="math inline">\(s50\)</span> is a parameter controlling the point at which the function reaches 50% of the maximum (<span class="math inline">\(\psi\)</span>), and <span class="math inline">\(s95\)</span> is a parameter controlling the point at which the function reaches 95%. The parameter <span class="math inline">\(s50\)</span> is unconstrained, and <span class="math inline">\(s95\)</span> is constrained to be larger than <span class="math inline">\(s50\)</span>.</p>
<p>These models can be fit by including <code>+ logistic(x)</code> in the model formula, where <code>x</code> is a covariate.</p>
</div>
</div>
<div id="observation-model-families" class="section level2">
<h2 class="hasAnchor">
<a href="#observation-model-families" class="anchor"></a>Observation model families</h2>
<div id="binomial" class="section level3">
<h3 class="hasAnchor">
<a href="#binomial" class="anchor"></a><a href="https://kaskr.github.io/adcomp/group__R__style__distribution.html#gaee11f805f02bc1febc6d7bf0487671be">Binomial</a>
</h3>
<p>Internally parameterized as the <a href="https://kaskr.github.io/adcomp/group__R__style__distribution.html#gaecb5a18095a320b42e2d20c4b120f5f5">robust version</a>.</p>
</div>
<div id="beta" class="section level3">
<h3 class="hasAnchor">
<a href="#beta" class="anchor"></a><a href="https://kaskr.github.io/adcomp/group__R__style__distribution.html#ga5324c83759d5211c7c2fbbad37fa8e59">Beta</a>
</h3>
<p><span class="math display">\[
\operatorname{Beta} \left(\mu \phi, 1 - \mu \phi \right)
\]</span></p>
<p>where <span class="math inline">\(\phi\)</span> is variance.</p>
<p><span class="math display">\[
\operatorname{Binomial} \left( N, \mu \right)
\]</span></p>
<p><span class="math inline">\(N = 1\)</span> (i.e., ‘size’ currently fixed) and <span class="math inline">\(\mu\)</span> is probability</p>
</div>
<div id="gamma" class="section level3">
<h3 class="hasAnchor">
<a href="#gamma" class="anchor"></a><a href="https://kaskr.github.io/adcomp/group__R__style__distribution.html#gab0e2205710a698ad6a0ed39e0652c9a3">Gamma</a>
</h3>
<p>As shape, scale:</p>
<p><span class="math display">\[
\operatorname{Gamma} \left( \phi, \frac{\mu}{\phi}  \right)
\]</span></p>
<p>where <span class="math inline">\(\phi\)</span> represents the shape and <span class="math inline">\(\frac{\mu}{\phi}\)</span> represents the scale.</p>
</div>
<div id="gaussian" class="section level3">
<h3 class="hasAnchor">
<a href="#gaussian" class="anchor"></a><a href="https://kaskr.github.io/adcomp/dnorm_8hpp.html">Gaussian</a>
</h3>
<p><span class="math display">\[
\operatorname{Normal} \left( \mu, \phi \right)
\]</span> where <span class="math inline">\(\phi\)</span> is the standard deviation (following Stan convention of SD not variance).</p>
</div>
<div id="lognormal" class="section level3">
<h3 class="hasAnchor">
<a href="#lognormal" class="anchor"></a><a href="https://github.com/pbs-assess/sdmTMB/blob/28a93496a93b12e5a2f73f703bc96afbf14d86c1/src/sdmTMB.cpp#L22-L30">Lognormal</a>
</h3>
<p><span class="math display">\[
\operatorname{Lognormal} \left( \log \mu - \frac{\phi^2}{2}, \phi \right)
\]</span></p>
</div>
<div id="negative-binomial" class="section level3">
<h3 class="hasAnchor">
<a href="#negative-binomial" class="anchor"></a><a href="https://kaskr.github.io/adcomp/group__R__style__distribution.html#ga76266c19046e04b651fce93aa0810351">Negative Binomial</a>
</h3>
<p>Internally parameterized as the <a href="https://kaskr.github.io/adcomp/group__R__style__distribution.html#gaa23e3ede4669d941b0b54314ed42a75c">robust version</a></p>
<p><span class="math display">\[
\operatorname{NB2} \left( \mu, \phi \right)
\]</span></p>
<p>Variance scales quadratically with mean <span class="math inline">\(\mathrm{Var}[y] = \mu + \mu^2 / \phi\)</span>.</p>
</div>
<div id="poisson" class="section level3">
<h3 class="hasAnchor">
<a href="#poisson" class="anchor"></a><a href="https://kaskr.github.io/adcomp/group__R__style__distribution.html#gaa1ed15503e1441a381102a8c4c9baaf1">Poisson</a>
</h3>
<p><span class="math display">\[
\operatorname{Poisson} \left( \mu \right)
\]</span></p>
</div>
<div id="student-t" class="section level3">
<h3 class="hasAnchor">
<a href="#student-t" class="anchor"></a><a href="https://github.com/pbs-assess/sdmTMB/blob/28a93496a93b12e5a2f73f703bc96afbf14d86c1/src/sdmTMB.cpp#L11-L20">Student-t</a>
</h3>
<p><span class="math display">\[
\operatorname{Student-t} \left( \mu, \phi, \nu \right)
\]</span></p>
<p>where <span class="math inline">\(\nu\)</span>, the degrees of freedom, is currently fixed at 3.</p>
</div>
<div id="tweedie" class="section level3">
<h3 class="hasAnchor">
<a href="#tweedie" class="anchor"></a><a href="https://kaskr.github.io/adcomp/group__R__style__distribution.html#ga262f3c2d1cf36f322a62d902a608aae0">Tweedie</a>
</h3>
<p><a href="https://kaskr.github.io/adcomp/tweedie_8cpp_source.html">Source code</a> as in <a href="https://CRAN.R-project.org/package=cplm">cplm</a> package. <a href="https://link.springer.com/article/10.1007/s11222-012-9343-7" class="uri">https://link.springer.com/article/10.1007/s11222-012-9343-7</a></p>
<p><span class="math display">\[
\operatorname{Tweedie} \left(\mu, p, \phi \right), \: 1 &lt; p &lt; 2
\]</span></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sean C. Anderson, Eric J. Ward, Lewis A. K. Barnett, Philina A. English.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
